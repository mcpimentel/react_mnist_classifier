(this.webpackJsonpreact_mnist_classifier=this.webpackJsonpreact_mnist_classifier||[]).push([[0],{32:function(e,t,c){},34:function(e,t,c){},35:function(e,t,c){},43:function(e,t,c){},45:function(e,t,c){"use strict";c.r(t);var i=c(0),n=c(1),s=c.n(n),a=c(13),r=c.n(a),d=(c(32),c(5)),o=c.n(d),l=c(8),j=c(12),b=c(16),m=c(17),u=c(22),h=c(21),p=c(15),v=c(14);function x(e){var t=e.getImageData(0,0,e.canvas.width,e.canvas.height).data;return new v.Tensor(new Float32Array(t),"float32")}c(34);var O,f,N,g,y=!1,w=!0,k=280,E=.5,L=null,X=function(e){var t=e.session,c=e.modelloaded,s=Object(n.useRef)();Object(n.useEffect)((function(){var e=s.current;e.width=280,e.height=280,(L=e.getContext("2d")).lineWidth=28,L.lineJoin="round",L.font="28px sans-serif",L.textAlign="center",L.textBaseline="middle",L.fillStyle="#212121",L.strokeStyle="#212121",L.fillText("Write a number here!",140,140)}),[]),Object(n.useEffect)((function(){var e=s.current;e.addEventListener("mousedown",r),e.addEventListener("mousemove",b),document.body.addEventListener("mouseup",u),document.body.addEventListener("mouseout",v),e.addEventListener("touchstart",d),e.addEventListener("touchmove",m),document.body.addEventListener("touchend",h)}));var a=function(e){var t=e.fromX,c=e.fromY,i=e.toX,n=e.toY;L.beginPath(),L.moveTo(t,c),L.lineTo(i,n),L.closePath(),L.stroke(),g()},r=function(e){y=!0,w&&(N(),w=!1);var t=e.offsetX/E,c=e.offsetY/E;O=t+.001,f=c+.001,b(e)},d=function(e){y=!0,w&&(N(),w=!1);var t=e.target.getBoundingClientRect(),c=(e.targetTouches[0].clientX-t.x)/E,i=(e.targetTouches[0].clientY-t.y)/E;O=c+.001,f=i+.001,m(e)},b=function(e){var t=e.offsetX/E,c=e.offsetY/E;y&&a({fromX:O,fromY:f,toX:t,toY:c}),O=t,f=c},m=function(e){var t=e.target.getBoundingClientRect(),c=(e.targetTouches[0].clientX-t.x)/E,i=(e.targetTouches[0].clientY-t.y)/E;y&&a({fromX:O,fromY:f,toX:c,toY:i}),O=c,f=i},u=function(){y=!1},h=function(){y=!1},v=function(){y=!1},N=function(){L.clearRect(0,0,k,k);for(var e=0;e<10;e++){var t=document.getElementById("prediction-".concat(e));t.className="prediction-col",t.children[1].children[0].style.width="0",t.className="prediction-col"}},g=function(){var e=Object(l.a)(o.a.mark((function e(){var i,n,s,a,r,d,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==c){e.next=9;break}return i=x(L),e.next=4,t.run([i]);case 4:for(n=e.sent,s=n.values().next().value,a=s.data,r=Math.max.apply(Math,Object(p.a)(a)),d=0;d<a.length;d++)(l=document.getElementById("prediction-".concat(d))).children[1].children[0].style.width="".concat(100*a[d],"%"),l.className=a[d]===r?"prediction-col top-prediction":"prediction-col";case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsxs)("div",{style:{padding:10},children:[Object(i.jsx)("canvas",Object(j.a)({className:"canvas",ref:s},e)),Object(i.jsx)("div",{}),Object(i.jsx)("button",{className:"button",onClick:function(){N()},children:"CLEAR"}),Object(i.jsx)("div",{children:Object(i.jsxs)("div",{className:"predictions",children:[Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-0",children:[Object(i.jsx)("div",{className:"prediction-number",children:"0"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-1",children:[Object(i.jsx)("div",{className:"prediction-number",children:"1"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-2",children:[Object(i.jsx)("div",{className:"prediction-number",children:"2"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-3",children:[Object(i.jsx)("div",{className:"prediction-number",children:"3"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-4",children:[Object(i.jsx)("div",{className:"prediction-number",children:"4"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-5",children:[Object(i.jsx)("div",{className:"prediction-number",children:"5"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-6",children:[Object(i.jsx)("div",{className:"prediction-number",children:"6"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-7",children:[Object(i.jsx)("div",{className:"prediction-number",children:"7"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-8",children:[Object(i.jsx)("div",{className:"prediction-number",children:"8"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-9",children:[Object(i.jsx)("div",{className:"prediction-number",children:"9"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]})]})})]})},Y=(c(35),!1),_=!0,T=280,C=.5,S=null,M=function(e){var t=e.session,c=e.modelloaded,s=Object(n.useRef)();Object(n.useEffect)((function(){var e=s.current;e.width=280,e.height=280,(S=e.getContext("2d")).lineWidth=28,S.lineJoin="round",S.font="28px sans-serif",S.textAlign="center",S.textBaseline="middle",S.fillStyle="#212121",S.strokeStyle="#212121",S.fillText("Write a number here!",140,140)}),[]),Object(n.useEffect)((function(){var e=s.current;e.addEventListener("mousedown",r),e.addEventListener("mousemove",b),document.body.addEventListener("mouseup",u),document.body.addEventListener("mouseout",v),e.addEventListener("touchstart",d),e.addEventListener("touchmove",m),document.body.addEventListener("touchend",h)}));var a=function(e){var t=e.fromX,c=e.fromY,i=e.toX,n=e.toY;S.beginPath(),S.moveTo(t,c),S.lineTo(i,n),S.closePath(),S.stroke(),y()},r=function(e){Y=!0,_&&(O(),_=!1);var t=e.offsetX/C,c=e.offsetY/C;N=t+.001,g=c+.001,b(e)},d=function(e){Y=!0,_&&(O(),_=!1);var t=e.target.getBoundingClientRect(),c=(e.targetTouches[0].clientX-t.x)/C,i=(e.targetTouches[0].clientY-t.y)/C;N=c+.001,g=i+.001,m(e)},b=function(e){var t=e.offsetX/C,c=e.offsetY/C;Y&&a({fromX:N,fromY:g,toX:t,toY:c}),N=t,g=c},m=function(e){var t=e.target.getBoundingClientRect(),c=(e.targetTouches[0].clientX-t.x)/C,i=(e.targetTouches[0].clientY-t.y)/C;Y&&a({fromX:N,fromY:g,toX:c,toY:i}),N=c,g=i},u=function(){Y=!1},h=function(){Y=!1},v=function(){Y=!1},O=function(){S.clearRect(0,0,T,T);for(var e=0;e<11;e++){var t=document.getElementById("prediction-u-".concat(e));t.className="prediction-col",t.children[1].children[0].style.width="0",t.className="prediction-col"}},f=function(e){var t=200*Math.sqrt(Math.max.apply(Math,Object(p.a)(Object(p.a)(e).splice(10,19))));return t>100?100:t},y=function(){var e=Object(l.a)(o.a.mark((function e(){var i,n,s,a,r,d,l,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==c){e.next=12;break}return i=x(S),e.next=4,t.run([i]);case 4:for(n=e.sent,s=n.values().next().value,a=s.data,r=Math.max.apply(Math,Object(p.a)(a)),d=0;d<10;d++)(l=document.getElementById("prediction-u-".concat(d))).children[1].children[0].style.width="".concat(100*a[d],"%"),l.className=a[d]===r?"prediction-col top-prediction-uncertain":"prediction-col";(j=document.getElementById("prediction-u-".concat(10))).children[1].children[0].style.width="".concat(f(a),"%"),j.className="prediction-col uncertain-prediction";case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsxs)("div",{style:{padding:10},children:[Object(i.jsx)("canvas",Object(j.a)({className:"canvas",ref:s},e)),Object(i.jsx)("div",{}),Object(i.jsx)("button",{className:"button",onClick:function(){O()},children:"CLEAR"}),Object(i.jsx)("div",{children:Object(i.jsxs)("div",{className:"predictions",children:[Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-0",children:[Object(i.jsx)("div",{className:"prediction-number",children:"0"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-1",children:[Object(i.jsx)("div",{className:"prediction-number",children:"1"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-2",children:[Object(i.jsx)("div",{className:"prediction-number",children:"2"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-3",children:[Object(i.jsx)("div",{className:"prediction-number",children:"3"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-4",children:[Object(i.jsx)("div",{className:"prediction-number",children:"4"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-5",children:[Object(i.jsx)("div",{className:"prediction-number",children:"5"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-6",children:[Object(i.jsx)("div",{className:"prediction-number",children:"6"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-7",children:[Object(i.jsx)("div",{className:"prediction-number",children:"7"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-8",children:[Object(i.jsx)("div",{className:"prediction-number",children:"8"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-9",children:[Object(i.jsx)("div",{className:"prediction-number",children:"9"}),Object(i.jsx)("div",{className:"prediction-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]}),Object(i.jsxs)("div",{className:"prediction-col",id:"prediction-u-10",children:[Object(i.jsx)("div",{className:"prediction-number",children:"U"}),Object(i.jsx)("div",{className:"prediction-uncertainty-bar-container",children:Object(i.jsx)("div",{className:"prediction-bar"})})]})]})})]})},B=c(26),I=c(25),R=function(e){Object(u.a)(c,e);var t=Object(h.a)(c);function c(e,i){var n;return Object(b.a)(this,c),(n=t.call(this,e,i)).state={key:"home"},n}return Object(m.a)(c,[{key:"render",value:function(){var e=this,t=this.props,c=t.session,n=t.session2,s=this.props.status,a=s.modelloaded,r=s.model2loaded,d=s.modelloading,o=s.model2loading;return 1===d|1===o?Object(i.jsx)("div",{children:"Loading models..."}):0===d&0===o&0===a&0===r?Object(i.jsx)("div",{children:"Found a problem loading the models..."}):Object(i.jsx)("div",{children:Object(i.jsxs)(B.a,{activeKey:this.state.key,id:"tab_controller",onSelect:function(t){return e.setState({key:t})},children:[Object(i.jsx)(I.a,{eventKey:"home",title:"Standard",children:Object(i.jsx)(X,{modelloaded:a,session:c})}),Object(i.jsx)(I.a,{eventKey:"uncertain",title:"With Uncertainty",children:Object(i.jsx)(M,{modelloaded:r,session:n})})]})})}}]),c}(s.a.Component),A=(c(43),{modelloading:0,modelloaded:0,model2loading:0,model2loaded:0,backendHint:"webgl"}),F="./models/onnx_lenet_standard.onnx",H="./models/onnx_lenet_manualdropout.onnx";"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname||(F="./react_mnist_classifier/models/onnx_lenet_standard.onnx",H="./react_mnist_classifier/models/onnx_lenet_manualdropout.onnx");var J=function(e){Object(u.a)(c,e);var t=Object(h.a)(c);function c(){var e;Object(b.a)(this,c);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state=Object(j.a)({},A),e.session=new v.InferenceSession({backendHint:e.state.backendHint}),e.session2=new v.InferenceSession({backendHint:e.state.backendHint}),e.loadModel=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.state.modelloaded){t.next=6;break}return e.setState({modelLoading:1}),t.next=5,e.session.loadModel(F);case 5:e.setState({modelloaded:1,modelLoading:0});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.loadModel2=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.state.model2Loaded){t.next=6;break}return e.setState({model2Loading:1}),t.next=5,e.session2.loadModel(H);case 5:e.setState({model2loaded:1,model2Loading:0});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e}return Object(m.a)(c,[{key:"componentDidMount",value:function(){this.loadModel(),this.loadModel2()}},{key:"render",value:function(){return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("header",{className:"App-header",children:["Handwritten digits classification.",Object(i.jsx)("p",{children:" A simple demo of a classification model running on the browser "})]}),Object(i.jsxs)("p",{children:[" The app is implemented using ",Object(i.jsx)("a",{href:"https://reactjs.org/",children:"ReactJS"})," and ",Object(i.jsx)("a",{href:"https://github.com/microsoft/onnxjs",children:"ONNXJS"}),". See ",Object(i.jsx)("a",{href:"https://github.com/mcpimentel/react_mnist_classifier",children:"here"})," for code and other details. "]}),Object(i.jsx)("p",{children:" It has been tested with Google Chrome (both desktop and mobile devices)! Have not conducted extensive tests on other browsers! "}),Object(i.jsx)("p",{children:' "U" corresponds to an estimation of uncertainty in the prediction!'}),Object(i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(i.jsx)(R,{status:this.state,session:this.session,session2:this.session2})})]})}}]),c}(s.a.Component),P=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,47)).then((function(t){var c=t.getCLS,i=t.getFID,n=t.getFCP,s=t.getLCP,a=t.getTTFB;c(e),i(e),n(e),s(e),a(e)}))};c(44);r.a.render(Object(i.jsx)(s.a.Fragment,{children:Object(i.jsx)(J,{})}),document.getElementById("root")),P()}},[[45,1,2]]]);
//# sourceMappingURL=main.dd67f447.chunk.js.map