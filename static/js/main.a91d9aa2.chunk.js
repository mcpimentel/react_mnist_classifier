(this.webpackJsonpreact_mnist_classifier=this.webpackJsonpreact_mnist_classifier||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n(1),s=n.n(i),a=n(7),r=n.n(a),o=(n(18),n(2)),d=n.n(o),l=n(3),j=n(5),b=n(8),m=n(9),u=n(12),h=n(10),p=n(11),v=n(4);function x(e){var t=e.getImageData(0,0,e.canvas.width,e.canvas.height).data;return new v.Tensor(new Float32Array(t),"float32")}n(20);var f,O,N=!1,g=!0,w=280,y=.5,L=null,k=function(e){var t=e.session,n=e.status,s=Object(i.useRef)();Object(i.useEffect)((function(){var e=s.current;e.width=280,e.height=280,(L=e.getContext("2d")).lineWidth=28,L.lineJoin="round",L.font="28px sans-serif",L.textAlign="center",L.textBaseline="middle",L.fillStyle="#212121",L.strokeStyle="#212121",L.fillText("Write a number here!",140,140)}),[]),Object(i.useEffect)((function(){var e=s.current;e.addEventListener("mousedown",r),e.addEventListener("mousemove",b),document.body.addEventListener("mouseup",u),document.body.addEventListener("mouseout",v),e.addEventListener("touchstart",o),e.addEventListener("touchmove",m),document.body.addEventListener("touchend",h)}));var a=function(e){var t=e.fromX,n=e.fromY,c=e.toX,i=e.toY;L.beginPath(),L.moveTo(t,n),L.lineTo(c,i),L.closePath(),L.stroke(),E()},r=function(e){N=!0,g&&(k(),g=!1);var t=e.offsetX/y,n=e.offsetY/y;f=t+.001,O=n+.001,b(e)},o=function(e){N=!0,g&&(k(),g=!1);var t=e.target.getBoundingClientRect(),n=(e.targetTouches[0].clientX-t.x)/y,c=(e.targetTouches[0].clientY-t.y)/y;f=n+.001,O=c+.001,m(e)},b=function(e){var t=e.offsetX/y,n=e.offsetY/y;N&&a({fromX:f,fromY:O,toX:t,toY:n}),f=t,O=n},m=function(e){var t=e.target.getBoundingClientRect(),n=(e.targetTouches[0].clientX-t.x)/y,c=(e.targetTouches[0].clientY-t.y)/y;N&&a({fromX:f,fromY:O,toX:n,toY:c}),f=n,O=c},u=function(){N=!1},h=function(){N=!1},v=function(){N=!1},k=function(){L.clearRect(0,0,w,w);for(var e=0;e<10;e++){var t=document.getElementById("prediction-".concat(e));t.className="prediction-col",t.children[1].children[0].style.width="0",t.className="prediction-col"}},E=function(){var e=Object(l.a)(d.a.mark((function e(){var c,i,s,a,r,o,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!n.modelLoaded){e.next=9;break}return c=x(L),e.next=4,t.run([c]);case 4:for(i=e.sent,s=i.values().next().value,a=s.data,r=Math.max.apply(Math,Object(p.a)(a)),o=0;o<a.length;o++)(l=document.getElementById("prediction-".concat(o))).children[1].children[0].style.width="".concat(100*a[o],"%"),l.className=a[o]===r?"prediction-col top-prediction":"prediction-col";case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)("div",{style:{padding:10},children:[Object(c.jsx)("canvas",Object(j.a)({className:"canvas",ref:s},e)),Object(c.jsx)("div",{}),Object(c.jsx)("button",{className:"button",onClick:function(){k()},children:"CLEAR"}),Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"predictions",children:[Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-0",children:[Object(c.jsx)("div",{className:"prediction-number",children:"0"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-1",children:[Object(c.jsx)("div",{className:"prediction-number",children:"1"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-2",children:[Object(c.jsx)("div",{className:"prediction-number",children:"2"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-3",children:[Object(c.jsx)("div",{className:"prediction-number",children:"3"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-4",children:[Object(c.jsx)("div",{className:"prediction-number",children:"4"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-5",children:[Object(c.jsx)("div",{className:"prediction-number",children:"5"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-6",children:[Object(c.jsx)("div",{className:"prediction-number",children:"6"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-7",children:[Object(c.jsx)("div",{className:"prediction-number",children:"7"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-8",children:[Object(c.jsx)("div",{className:"prediction-number",children:"8"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]}),Object(c.jsxs)("div",{className:"prediction-col",id:"prediction-9",children:[Object(c.jsx)("div",{className:"prediction-number",children:"9"}),Object(c.jsx)("div",{className:"prediction-bar-container",children:Object(c.jsx)("div",{className:"prediction-bar"})})]})]})})]})},E=(n(21),{sessionRunning:!1,inferenceTime:0,error:!1,output:[],modelLoading:!1,modelLoaded:!1,backendHint:"webgl",selectedImage:null}),T="./models/onnx_model.onnx";"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname||(T="./react_mnist_classifier/models/onnx_model.onnx");var X=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(b.a)(this,n);for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state=Object(j.a)({},E),e.session=new v.InferenceSession({backendHint:e.state.backendHint}),e.runModel=Object(l.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.state.modelLoaded){t.next=6;break}return e.setState({modelLoading:!0}),t.next=5,e.session.loadModel(T);case 5:e.setState({modelLoaded:!0,modelLoading:!1});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.runModel()}},{key:"render",value:function(){return Object(c.jsxs)("div",{className:"App",children:[Object(c.jsxs)("header",{className:"App-header",children:["Handwritten digits classification.",Object(c.jsx)("p",{children:" A simple demo of a classification model running on the browser "})]}),Object(c.jsxs)("p",{children:[" The app is implemented using ",Object(c.jsx)("a",{href:"https://reactjs.org/",children:"ReactJS"})," and ",Object(c.jsx)("a",{href:"https://github.com/microsoft/onnxjs",children:"ONNXJS"}),". See ",Object(c.jsx)("a",{href:"https://github.com/mcpimentel/react_mnist_classifier",children:"here"})," for code and other details. "]}),Object(c.jsx)("p",{children:" This app has been tested with Google Chrome (both desktop and mobile devices)! "}),Object(c.jsx)(k,{status:this.state,session:this.session})]})}}]),n}(s.a.Component),C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),s(e),a(e)}))};r.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(X,{})}),document.getElementById("root")),C()}},[[22,1,2]]]);
//# sourceMappingURL=main.a91d9aa2.chunk.js.map